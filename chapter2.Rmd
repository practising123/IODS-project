# Insert chapter 2 title here

*Describe the work you have done this week and summarize your learning.*

- Describe your work and results clearly. 
- Assume the reader has an introductory course level understanding of writing and reading R code as well as statistical methods
- Assume the reader has no previous knowledge of your data or the more advanced methods you are using  

- did the wrangling part + dataCamp exercises.
Wrangling code:
```{r,dpi = 200, message=FALSE}
library(dplyr)
library(ggplot2)
library(GGally)
lrn14 <- read.table("http://www.helsinki.fi/~kvehkala/JYTmooc/JYTOPKYS3-
data.txt", sep="\t", header=TRUE)
dim(lrn14)
str(lrn14)
#reading the table from web and saving to lrn14. 183 rows/persons, 60 variables.

deep_questions <- c("D03", "D11", "D19", "D27", "D07", "D14", "D22", "D30","D06",  "D15", "D23", "D31")
deep_columns <- select(lrn14, one_of(deep_questions))
deep <- rowMeans((deep_columns))
surface_questions <- c("SU02","SU10","SU18","SU26", "SU05","SU13","SU21","SU29","SU08","SU16","SU24","SU32")
surface_columns <- select(lrn14, one_of(surface_questions))
surf <- rowMeans(surface_columns)
strategic_questions <- c("ST01","ST09","ST17","ST25","ST04","ST12","ST20","ST28")
strategic_columns <- select(lrn14, one_of(strategic_questions))
stra <- rowMeans(strategic_columns)

#taking means of courses to create new combination variables


keep_columns <- c("gender","Age","Attitude", "Points")
learning2014 <- select(lrn14, one_of(keep_columns))
#decide columns to take and retrieve all of them to "learning2014"
#Choosing the columns, creating new data frame learning2014 for analyzing.
learning2014$deep <- deep
learning2014$stra <- stra
learning2014$surf <- surf
learning2014 <-filter(learning2014, Points>0)
str(learning2014)
dim(learning2014)
#insert compilation variables and filtering zero-pointers.

write.table(learning2014, file = "data/learning2014.txt", row.names = TRUE)

new_table <- read.table(file = "data/learning2014.txt", header=TRUE)
dim(new_table)
str(new_table)

#saving and loading from /data

#Analysis
#2.1
new_table <- read.table(file = "data/learning2014.txt", header=TRUE)
summary(new_table)
```
#2.2
```{r,dpi = 200, message=FALSE}
summary(new_table)
#The data contains study information on 166 individuals, with 7 variables: Age(years), gender (F/M), Attitude, points, deep, stra and surf.
#Attitude is mean of answers on multiple questions measuring students attitude towards statistics. Deep, stra and surf are means of multiple questions measuring these subjects. Points is exam points.



p <- ggpairs(new_table, mapping = aes(col=gender, alpha=0.3), lower = list(combo = wrap("facethist", bins = 20)))
p

#Creates the plot of new_table and prints it.

#Notes on data:

#Only 56/166 are men.
table(cut(new_table$Age, breaks = seq(15,55,by=10)))
#most of the students are between 15 and 25 years, on the youngest category. Mean is bigger then median so the distribution of age is skewed to the left.
table(new_table$gender, cut(new_table$Attitude, breaks = seq(1,56,by=5)))
#Shows that male have better attitude on statistics then female.
#Biggest correlations are between points and attitude 0.437 and stra 0.146.

#2.3

my_model <- lm(Points ~ Attitude + stra + surf, data = new_table)
summary(my_model)
#Apparently Attitude having .34 regression to points is significant, attitude has ***
#Multiple R-squared:  0.21 and 0.34 regression.
#dropping stra and surf because those are not relevant.
my_model <- lm(Points ~ Attitude, data = new_table)
#2.4
summary(my_model)
#Multiple R-squared:  0.19 and 0.35 regression. predictors explain 19% of variance. 1 point in attitude raises exam points by 3.53 on average.

my_model <- lm(Points ~ Attitude, data = new_table)
summary(my_model)
plot(my_model, which =c(1))
#

```
2.5
#Assumptions of linear regression models:
#The errors are normally distributed
#The errors are not correlated
#The errors have constant variance, ??2

#The size of a given error does not depend on the explanatory variables

```{r,dpi = 200, message=FALSE}
plot(my_model, which =c(1))
#Residual vs fitted. Tells if there are patterns. patterns mean problem with the assumption. if there would be bigger residual on bigger values, the assumption(my_model) would need to be corrected.Residuals seem to be scattered evenly(variance seems constant). 
plot(my_model, which =c(2))
#The Q-Q-plot most of the points are on line with litlle mix in the ends. shows the error assumption.
plot(my_model, which =c(5))
#Tells if there are influentical cases in the model. if there are cases on topor bottom right, those would strongly influence the results.









```